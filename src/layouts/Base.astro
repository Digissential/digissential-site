---
import '@styles/tailwind.css';
import LocalBusinessLD from '@components/LocalBusinessLD.astro';
import Footer from '@components/Footer.astro';
import Header from '@components/Header.astro';

interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
  noindex?: boolean;
  lang?: 'en' | 'af';
  altHref?: { en: string; af: string } | null;
}

const site = Astro.site?.toString?.() || 'https://www.digissential.co.za';

const {
  title = 'Digissential â€” Computer Repair & IT Support in Stellenbosch',
  description = 'Fast, honest computer repairs and IT support. Windows installs, data recovery, malware removal, upgrades, and on-site service. Keeping your tech essentials perfect!',
  ogImage = '/social.png',
  noindex = false,
  lang = 'en',
  altHref = null,
} = Astro.props as Props;

const canonical = new URL(Astro.url.pathname || '/', site).toString();
const ogAbs = new URL(ogImage, site).toString();   // <-- single declaration
---



<!doctype html>
<html lang={lang} class="scroll-smooth">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    <title>{title}</title>

    <link rel="canonical" href={canonical} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogAbs} />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonical} />
    <meta property="og:site_name" content="Digissential" />


    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogAbs} />

    {noindex && <meta name="robots" content="noindex,nofollow" />}
    {altHref && (
      <>
        <link rel="alternate" hrefLang="en" href={new URL(altHref.en, site).toString()} />
        <link rel="alternate" hrefLang="af" href={new URL(altHref.af, site).toString()} />
        <link rel="alternate" hrefLang="x-default" href={new URL(altHref.en, site).toString()} />
      </>
    )}
    <link rel="alternate" type="application/rss+xml" title="Digissential Blog" href="/rss.xml" />

    <link rel="icon" href="/favicon.svg" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>

    <meta name="theme-color" content="#0b1220" />
    <meta name="generator" content={Astro.generator} />

    <LocalBusinessLD />
  </head>

  <body class="min-h-screen flex flex-col bg-digi-bg text-white">
    <a href="#main" class="sr-only focus:not-sr-only focus:absolute focus:top-3 focus:left-3 bg-black/80 text-white px-3 py-2 rounded">
      Skip to content
    </a>
  
  
    <!-- Sticky site header -->
    <header class="sticky top-0 z-50 border-b border-white/5 bg-digi-ink/80 backdrop-blur supports-[backdrop-filter]:bg-digi-ink/60">
      <Header />
    </header>

    <!-- Page content -->
    <main class="flex-1">
      <slot />
    </main>

    <Footer />
  </body>
</html>
